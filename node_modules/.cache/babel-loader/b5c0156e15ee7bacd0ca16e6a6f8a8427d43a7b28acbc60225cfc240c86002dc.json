{"ast":null,"code":"import io from\"socket.io-client\";import React from'react';import store from'../store';import lobbySlice from\"../lobbySlice\";export const socket=io.connect('https://royalgames-server.replit.app');// export const socket = io.connect('http://localhost:3001');\nexport const SocketContext=/*#__PURE__*/React.createContext();socket.on('connect',()=>{socket.emit('login',{key:localStorage.getItem('key')});const waitForLoginTimeout=setTimeout(()=>{// propably invalid key in localStorage\nlocalStorage.removeItem('key');socket.emit('login',{key:localStorage.getItem('key')});},5000);socket.on('login',data=>{clearTimeout(waitForLoginTimeout);if(data.status==='logged-in'){localStorage.setItem('key',data.key);store.dispatch(lobbySlice.actions.updateLoginState({status:data.status,username:data.username}));store.dispatch(lobbySlice.actions.updateBalance(data.balance));}});});socket.on('disconnect',()=>{store.dispatch(lobbySlice.actions.updateLoginState('logged-out'));store.dispatch(lobbySlice.actions.updateBalance(0));});","map":{"version":3,"names":["io","React","store","lobbySlice","socket","connect","SocketContext","createContext","on","emit","key","localStorage","getItem","waitForLoginTimeout","setTimeout","removeItem","data","clearTimeout","status","setItem","dispatch","actions","updateLoginState","username","updateBalance","balance"],"sources":["/home/user/Desktop/Projects/RoyalGames/royalgames-client/src/context/socket.js"],"sourcesContent":["import io from \"socket.io-client\";\nimport React from 'react';\nimport store from '../store';\nimport lobbySlice from \"../lobbySlice\";\n\nexport const socket = io.connect('https://royalgames-server.replit.app');\n// export const socket = io.connect('http://localhost:3001');\nexport const SocketContext = React.createContext();\n\nsocket.on('connect', () => {\n\n  socket.emit('login', {\n    key: localStorage.getItem('key'),\n  });\n  const waitForLoginTimeout = setTimeout(() => {\n    // propably invalid key in localStorage\n    localStorage.removeItem('key');\n\n    socket.emit('login', {\n      key: localStorage.getItem('key'),\n    });\n  }, 5000);\n\n  socket.on('login', (data) => {\n    clearTimeout(waitForLoginTimeout);\n\n    if (data.status === 'logged-in') {\n      localStorage.setItem('key', data.key);\n\n      store.dispatch(lobbySlice.actions.updateLoginState({\n        status: data.status,\n        username: data.username,\n      }));\n      store.dispatch(lobbySlice.actions.updateBalance(data.balance));\n    }\n  });\n});\n\nsocket.on('disconnect', () => {\n  store.dispatch(lobbySlice.actions.updateLoginState('logged-out'));\n  store.dispatch(lobbySlice.actions.updateBalance(0));\n});\n"],"mappings":"AAAA,MAAO,CAAAA,EAAE,KAAM,kBAAkB,CACjC,MAAO,CAAAC,KAAK,KAAM,OAAO,CACzB,MAAO,CAAAC,KAAK,KAAM,UAAU,CAC5B,MAAO,CAAAC,UAAU,KAAM,eAAe,CAEtC,MAAO,MAAM,CAAAC,MAAM,CAAGJ,EAAE,CAACK,OAAO,CAAC,sCAAsC,CAAC,CACxE;AACA,MAAO,MAAM,CAAAC,aAAa,cAAGL,KAAK,CAACM,aAAa,CAAC,CAAC,CAElDH,MAAM,CAACI,EAAE,CAAC,SAAS,CAAE,IAAM,CAEzBJ,MAAM,CAACK,IAAI,CAAC,OAAO,CAAE,CACnBC,GAAG,CAAEC,YAAY,CAACC,OAAO,CAAC,KAAK,CACjC,CAAC,CAAC,CACF,KAAM,CAAAC,mBAAmB,CAAGC,UAAU,CAAC,IAAM,CAC3C;AACAH,YAAY,CAACI,UAAU,CAAC,KAAK,CAAC,CAE9BX,MAAM,CAACK,IAAI,CAAC,OAAO,CAAE,CACnBC,GAAG,CAAEC,YAAY,CAACC,OAAO,CAAC,KAAK,CACjC,CAAC,CAAC,CACJ,CAAC,CAAE,IAAI,CAAC,CAERR,MAAM,CAACI,EAAE,CAAC,OAAO,CAAGQ,IAAI,EAAK,CAC3BC,YAAY,CAACJ,mBAAmB,CAAC,CAEjC,GAAIG,IAAI,CAACE,MAAM,GAAK,WAAW,CAAE,CAC/BP,YAAY,CAACQ,OAAO,CAAC,KAAK,CAAEH,IAAI,CAACN,GAAG,CAAC,CAErCR,KAAK,CAACkB,QAAQ,CAACjB,UAAU,CAACkB,OAAO,CAACC,gBAAgB,CAAC,CACjDJ,MAAM,CAAEF,IAAI,CAACE,MAAM,CACnBK,QAAQ,CAAEP,IAAI,CAACO,QACjB,CAAC,CAAC,CAAC,CACHrB,KAAK,CAACkB,QAAQ,CAACjB,UAAU,CAACkB,OAAO,CAACG,aAAa,CAACR,IAAI,CAACS,OAAO,CAAC,CAAC,CAChE,CACF,CAAC,CAAC,CACJ,CAAC,CAAC,CAEFrB,MAAM,CAACI,EAAE,CAAC,YAAY,CAAE,IAAM,CAC5BN,KAAK,CAACkB,QAAQ,CAACjB,UAAU,CAACkB,OAAO,CAACC,gBAAgB,CAAC,YAAY,CAAC,CAAC,CACjEpB,KAAK,CAACkB,QAAQ,CAACjB,UAAU,CAACkB,OAAO,CAACG,aAAa,CAAC,CAAC,CAAC,CAAC,CACrD,CAAC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}